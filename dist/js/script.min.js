window.onload = function () {
    document.body;
    var e = document.querySelector(".burger-menu");
    let t = document.querySelector(".burger-menu_open");
    var l = document.querySelector(".close-icon");
    let n = document.querySelector(".popup");
    var s = document.querySelector(".popup-close");
    let r = document.getElementById("contact-form"),
        a = r.querySelector(".name"),
        i = r.querySelector(".email"),
        o = r.querySelector("textarea");
    s.addEventListener("click", function () {
        (n.style.opacity = "0"), (n.style.top = "-250px");
    }),
        e.addEventListener("click", function () {
            (t.style = "top:90px;"),
                (e.style = "display:none;"),
                (l.style = "display:block;");
        }),
        l.addEventListener("click", function () {
            (t.style = "top:-250px"),
                (l.style = "display:none;"),
                (e.style = "display:block;");
        }),
        emailjs.init("GyiJlYYijJjsag2K9"),
        r.addEventListener("submit", function (e) {
            e.preventDefault();
            if (
                (function e() {
                    let t = !0;
                    function l(e) {
                        let t = e.nextElementSibling;
                        t &&
                            t.classList.contains("error-message") &&
                            t.remove();
                    }
                    function n(e, t) {
                        l(e);
                        let n = document.createElement("span");
                        n.classList.add("error-message"),
                            (n.style.color = "red"),
                            (n.style.position = "absolute"),
                            (n.style.left = "0"),
                            (n.style.bottom = "-20px"),
                            (n.style.fontFamily = "Poppins"),
                            (n.style.fontSize = "12px"),
                            (n.innerText = t),
                            e.parentElement.appendChild(n);
                    }
                    return (
                        a.value.trim().length < 3
                            ? (n(
                                  a,
                                  "The name must be no shorter than 3 characters"
                              ),
                              (t = !1))
                            : l(a),
                        /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.value.trim())
                            ? l(i)
                            : (n(i, "Enter a valid email address"), (t = !1)),
                        o.value.trim().length < 10
                            ? (n(
                                  o,
                                  "Message must contain a minimum of 10 characters"
                              ),
                              (t = !1))
                            : l(o),
                        t
                    );
                })()
            ) {
                let t = {
                    name: a.value.trim(),
                    email: i.value.trim(),
                    message: o.value.trim(),
                };
                emailjs.send("default_service", "template_ytncs4i", t).then(
                    () => {
                        (n.style.opacity = "1"),
                            (n.style.top = "50%"),
                            r.reset();
                    },
                    () => {
                        alert("Произошла ошибка.");
                    }
                );
            }
        });
};
